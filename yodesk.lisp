;; Data types
(defun read-string (stream length)
  "Reads a string from the passed in stream of the specified length"
  (let ((str (loop for i upto (1- length)
                   collect (read-byte stream))))
    (format nil "窿磲疸狎＇泔溴汨狎篝颟┅ㄤ彐躅蝈徜桢徜弪篝蝈犴⒁遽潴箦泗轱桢徜弪喘汨狎徙翦祜铉篝蜷铉溴铒糸铉箦泗轱镦翳轶忾钺蝙骘蝽狒蝈徜篝蜷铉篝蝈犴穿ㄤ彐躅蝈徜铛礅弪篝蝈犴脲戾铉翳穿ㄥ钿獒红轸綮瀛孱溟犷┅⒁遽潴铛礅弪骝镯翳疳篌邃轭篝蝈犴溴驷蹯趔麸怡翦犷红轸綮瀛孱溟犷怩翳矬汜忮汨犷珏麸衡殓孱溟犷矧犷铛礅弪镦怡翦螈戾舄è铛眢祜镳骘躔麸ū戾铉翳泔祆邈蝈徜怡翦篝蝈犴┅铛眢ㄩㄥ孱溟犷衡殓孱溟犷蝈鲥蝮铛眢铛眢┅祜镳骘铛轭铛眢犷骝镯篚眄轭ㄡ箬铛í椹┅┅ㄤ彐躅蝈徜鲥蝮轱篝蝈犴⒁遽潴鲥蝮轱铛礅弪骝镯翳疳篌邃轭篝蝈犴ǐ蝈徜铛礅弪篝蝈犴红孱玺哄钿獒衡殓孱溟犷ǒ蝈徜铛礅弪篝蝈犴红孱玺哄钿獒衡殓孱溟犷卑鞍癌┅ㄤ彐躅蝈徜溽翎篝蝈犴戾铉翳⒁遽潴铛礅弪镦怡翦轭麸扉篝矧躅糸哄镦祜镳骘躔麸ū戾铉翳骘怡翦蝈徜怡翦篝蝈犴铋哄镦泔祆邈怡翦┅换骑蝽狒溟篌邈糸镱ㄤ彐珏铄蜷疳蝮瀛箦泗轱豉疱篝蝈犴ê滹沲礤铘狒轱⒁遽潴箦泗轱犷蝈趱蝾涕篝溴筱蜷忾铉轸┅ㄤ彐躅疳蝮瀛篝蝈犴箦泗轱篝蝈犴⒁遽潴篝蝈犴桢徜弪骝镯翳疳篌邃轭篝蝈犴犷溟箴狒汨弩轸麸翳泔蝌邈蝈徜弪礤翳镤疳蝮瀛箦泗轱ㄩ铘弪蝈徜桢徜弪篝蝈犴弘妁黠蜾篝蝈犴┅ㄤ彐躅疳蝮瀛镤弩é镳糸镱犰ㄦ殪①夏庞水脑立┅⑿狎箦翳傧呐铀脑溽翎骈戾鏖翳镳孱骈戾篝蝈犴骈戾哄戾礤铘豉疱Ж躅箝珙邃怡翦俯祜镳骘疳蝮邃疳蝮瀛篝蝈犴箦泗轱篝蝈犴泔祆邈疳蝮邃躅糸ㄥ哄钿ㄦ轵篝疳蝮邃┅┅换腻驷蹯驷祆忉汶ㄤ彐礤翳镤疳蝮瀛箦泗轱豉疱篝蝈犴⑷犷潇轭翳珏铄蜥箦泗轱篝戾戾舄è戾铉翳蝈徜铛礅弪篝蝈犴┅ㄤ狒蝈徜溽翎篝蝈犴戾铉翳┅扉篝豉疱红孱玺戾铉翳轰狒溽翎┅换皱蝮轱ㄤ彐礤翳镤疳蝮瀛箦泗轱è豉疱ㄥ耢忽弪螬篝蝈犴⑷犷潇轭翳鲥蝮轱睥扉篝豉疱红孱玺轰狒蝈徜鲥蝮轱篝蝈犴┅换陲铄ㄤ彐躅疳蝮瀛辁镱篝蝈犴⑿狎箦箝铉戾哨衔箦泗轱睥戾舄è铒殇遽蝈徜铛礅弪篝蝈犴红孱玺博戾铉翳蝈徜铛礅弪篝蝈犴红孱玺博铒殇遽蝈徜铛礅弪篝蝈犴┅ㄨ遽溴蝈徜桢徜弪篝蝈犴┅ㄤ狒蝈徜溽翎篝蝈犴ō戾铉翳订┅扉篝ㄩ铘弪桢徜弪弘妁黠蜾轰狒扉篝侯锃殇遽ㄣ镱铒殇遽铒殇遽博轰狒溽翎┅┅ㄤ彐礤翳镤疳蝮瀛箦泗轱è豉疱ㄥ耢胡镱濠篝蝈犴⑷犷潇弩翳堍谙闻堍箦泗轱镦翳忾钺蝙骈戾麒殂轭沆蹁弩怩钽镦铄篝邃哨衔螈戾舄è镱瀛泔躅蝈徜铛礅弪篝蝈犴红孱玺博ㄩ镱弩祜镳骘躔麸ū镱瀛泔躅舂泔祆邈疳蝮瀛辁镱篝蝈犴┅┅扉篝豉疱轰狒辁镱弩┅换身徵弩耢厚蹰汶祜徜胡痤绌祜徜疳戾趑瀹扉箴ㄤ彐躅珏舡泔祜ㄩ钿屮⑵弭汨弩泔祜扉篝骝镯翳疳祆弭澧戾èㄥ祠辛烫旁ǐí轭溴穿┅ㄧㄥ祠辛烫旁ǐí轭溴穿┅ㄢㄥ祠辛烫旁í轭溴穿┅扉篝猢┅ㄤ彐躅黩轸瀛痤糸戾溽翎钺礤脲鏖漪巢ㄨ彘玷巢┅⒆蜷翦犷轭溟鲩漉犰形骈戾玳鲥糸戾溽翎犷骈戾钺礤鏖翳镳孱骈戾秕钺礤轰轵邈糸镱猴豸瘐洪姝屮轶趔后躔弪箦溴哄戾礤铘豉疱Ж躅箝珙邃怡翦俯戾è痤磲脲轭篝犷沐痤绾痖屐篝蝈犴邃痤瑚殇翳鏖漪鸿彘玷桢殓梏┅痤绾篝狎舡痤痤秕舂祜镳骘痖屐轭糸戾溽翎滹痤绾黩轸瀛痖屐ㄧ弭泔祜痖屐痤绌痤绾骈铋箬痤痤绌┅ㄤ彐躅黩轸瀛痤珞糸戾溽翎脲ㄩ磲珏箝瀛怡翦卑泊ㄦ灬珞穿⑿狎箦糸戾溽翎轭麸箜犰戾轫徵弩犷黩轸弩翳屙徙泔蜾轭麸栾忾翳溽翎轶轭轫徵瀛箝瀛怡翦犷骒徵螈戾è蝈悱箝ǐ轫徵瀛箝瀛怡翦骒徵螬┅祜镳骘轫徵躔麸ūǒ戾铉翳糸戾溽翎蝈悱箝濠骘篝狎ǐ骒徵í蝈悱箝轫徵濠骘骒徵篚怏羼糸戾溽翎ō篝狎骒徵螬篝狎舂骘溽翎篚怏羼糸戾溽翎篝狎ǐ篝狎轫徵瀛箝瀛怡翦螬骘骈戾钺礤ㄦ矧磲铋㈤礴轫琬骒徵廉痤纰轫徵骒徵滹黩轸瀛痤溽翎骈戾钺礤┅┅